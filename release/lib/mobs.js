var Mob=me.ObjectEntity.extend({init:function(b,a,c){c.image=c.image;this.x=b;this.y=a;this.id=c.id;this.id_=c.id_;this.name=c.name;this.hp=c.hp;this.maxhp=c.maxhp;c.spritewidth=32;c.spriteheight=32;this.parent(b,a,c);this.setVelocity(c.vel,c.vel);this.destinationX=b;this.destinationY=a;this.setFriction(0.2,0.2);this.gravity=0;this.direction="down";this.addAnimation("down",[0,1,2]);this.addAnimation("left",[3,4,5]);this.addAnimation("up",[9,10,11]);this.addAnimation("right",[6,7,8]);this.addAnimation("stand-down",
[0]);this.addAnimation("stand-left",[3]);this.addAnimation("stand-up",[9]);this.addAnimation("stand-right",[6]);this.collidable=!0;this.type=me.game.ENEMY_OBJECT},update:function(){var b=this.pos.x,a=this.pos.y;hadSpeed=0!==this.vel.y||0!==this.vel.x;this.handleInput();updated=this.updateMovement();if(0===this.vel.x&&0===this.vel.y)this.setCurrentAnimation("stand-"+this.direction),hadSpeed&&(updated=!0);else if(res=me.game.collide(this))if(0<res.y&&(this.pos.y=a-1,this.destinationY=this.pos.y),0>
res.y&&(this.pos.y=a+1,this.destinationY=this.pos.y),0<res.x&&(this.pos.x=b-1,this.destinationX=this.pos.x),0>res.x)this.pos.x=b+1,this.destinationX=this.pos.x;updated&&this.parent(this);return updated},onCollision:function(){},handleInput:function(){this.destinationX<this.pos.x-10?(this.vel.x-=this.accel.x*me.timer.tick,this.setCurrentAnimation("left"),this.direction="left",now.updateMob(this.id_,this.pos)):this.destinationX>this.pos.x+10&&(this.vel.x+=this.accel.x*me.timer.tick,this.setCurrentAnimation("right"),
this.direction="right",now.updateMob(this.id_,this.pos));this.destinationY<this.pos.y-10?(this.vel.y=-this.accel.y*me.timer.tick,this.setCurrentAnimation("up"),this.direction="up",now.updateMob(this.id_,this.pos)):this.destinationY>this.pos.y+10&&(this.vel.y=this.accel.y*me.timer.tick,this.setCurrentAnimation("down"),this.direction="down",now.updateMob(this.id_,this.pos))}});
$(document).ready(function(){setInterval(function(){init&&("undefined"!=typeof now.mobs&&npcOn)&&$.each(now.mobs,function(b,a){if(!mobs[a.settings.id]&&0<a.settings.hp)mobs[a.settings.id]=new Mob(a.x,a.y,a.settings),mobs[a.settings.id].z=7,me.game.add(mobs[a.settings.id]),me.game.sort();else if(!(0>=a.settings.hp)){var c=mobs[a.settings.id];c.destinationX=a.x;c.destinationY=a.y;c.hp=a.settings.hp}})},500);now.updateMob_=function(b){if(init&&"undefined"!=typeof b.settings){var a=mobs[b.settings.id];
a.hp=b.settings.hp;a.destinationX=b.x;a.destinationY=b.y}};now.delMob=function(b){init&&mobs[b]&&(me.game.remove(mobs[b]),delete mobs[b])}});