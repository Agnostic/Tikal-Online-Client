var chatOn=!1,io,players={},playersAcc={},init=!1,local_inventario;now.ready(function(){console.log("NowJS Inicializado.");now.player={};now.player.hp=0;now.player.inventario={};updateHP(50)});function updateHP(b){now.player.hp+=b;now.player.hp>now.player.max_hp&&(now.player.hp=now.player.max_hp);b=100*now.player.hp/now.player.max_hp;$("#hp").css({width:b+"%"});$("#hp_txt").html(now.player.hp)}
function msgBox(b,a){$("#msgBox").html("<div class='tit_box'><b>"+b+"</b></div><div class='x'>x</div>"+a);$("#msgBox").fadeIn("fast")}function login(){$("#login").fadeOut(1E3,function(){msgBox("Connecting to Server","Please wait...");now.loginUsuario({u:$("#l_usuario").val(),p:$("#l_password").val()})})}function loadPlayer(b){$(".msgBox").fadeOut("fast");now.loadPlayer(b)}
$(document).ready(function(){function b(){""!=$("#chat_input").val()&&(now.enviarMensaje($("#chat_input").val()),$("#chat_input").val(""));$("#chat_input").blur()}$("#entrar").livequery("click",function(){login()});$(".msgBox").draggable({handle:".tit_box"});$("#panel button").animate({opacity:0.5},200);$(".x").livequery("click",function(){init||$("#login").fadeIn("fast");$(this).parent().fadeOut("fast")});$("#btn_stats").click(function(){$("#stats").fadeToggle("fast")});$("#btn_inv").click(function(){$("#inventory").fadeToggle("fast")});
$("#btn_online").click(function(){$("#u_online").fadeToggle("fast")});$("#btn_help").click(function(){$("#help").fadeToggle("fast")});$("#chat_input").livequery("click",function(){chatOn=!0});$("#enviar").livequery("click",function(){b()});now.loggedOn=function(a){1==a.l?(msgBox("Login",a.m),$(".msgBox").fadeOut("fast"),$("#register").fadeOut(500),jsApp.onload(),init=!0):0==a.l?msgBox("Login",a.m):(msgBox("Sorry...","Couldn't connect to server."),$("#l_usuario").focus())};$("#chat").mouseenter(function(){$("#chat").animate({opacity:1},
200)});$("#chat").mouseout(function(){chatOn||$("#chat").animate({opacity:0.5},200)});$("#panel button").mouseenter(function(){$(this).animate({opacity:1},200)});$("#panel button").mouseout(function(){$(this).animate({opacity:0.5},200)});$(document).keypress(function(a){init?13==a.keyCode?chatOn?(b(),chatOn=!1,$("#chat").animate({opacity:0.5},200),me.input.bindKey(me.input.KEY.X,"action")):(chatOn=!0,me.input.unbindKey(me.input.KEY.X),$("#chat").animate({opacity:1},200),$("#chat_input").focus()):
111==a.charCode?chatOn||$("#u_online").fadeToggle("fast"):112==a.charCode?chatOn||$("#stats").fadeToggle("fast"):105==a.charCode?chatOn||$("#inventory").fadeToggle("fast"):chatOn||$("#fix").focus():13==a.keyCode&&login()});now.u_online=function(a){$("#u_online").html("<div class='tit_box'>Players Online</div><div class='x'>x</div>");$.each(a,function(a,b){$("#u_online").append("<div>"+b.nick+"</div>")})};now.selectPlayers=function(a){$("#selectPlayers_").html("");var b=0;$.each(a,function(a,c){$("#select_players").append("<div>"+
a+"</div>");"undefined"!=typeof c.nick&&(playersAcc[b]=c,$("#selectPlayers_").append("<div class='sel_player' onclick='loadPlayer("+c.id+")'>"+c.nick+"</div>"),b++)});$(".msgBox").fadeOut("fast",function(){$("#selectPlayers").fadeIn("fast")})};$(window).unload(void 0);now.core.on("disconnect",function(){alert("You have been disconnected from the server!");location.reload(!0)});now.nuevoMensaje=function(a){$("#c_msgs").append(a);$("#c_msgs").animate({scrollTop:document.getElementById("c_msgs").scrollHeight},
1E3)};now.cargarInventario=function(a){for(var b=1;16>=b;)"undefined"!=typeof a[b].item&&""!=a[b].item&&$("#slot_"+b).html("<div class='item i"+a[b].item+"' rel='"+a[b].item+"'><div class='item_cant'>"+a[b].cantidad+"</div>"),b++;local_inventario=a;$(".item").draggable({revert:"invalid"})}});